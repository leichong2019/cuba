<!--
  ~ Copyright (c) 2008-2016 Haulmont.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  -->

<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        class="com.haulmont.cuba.gui.app.core.categories.AttributeEditor"
        messagesPack="com.haulmont.cuba.gui.app.core.categories"
        datasource="attributeDs"
        caption="msg://AttributeEditor.caption"
        focusComponent="attributeFieldGroup">
    <dsContext>
        <datasource
                id="attributeDs"
                class="com.haulmont.cuba.core.entity.CategoryAttribute"
                view="category.edit">
            <datasource id="configurationDs" property="configuration" allowCommit="false"/>
        </datasource>
        <collectionDatasource id="screensDs" class="com.haulmont.cuba.gui.app.core.categories.ScreenAndComponent"
                              allowCommit="false" refreshMode="NEVER"/>
    </dsContext>
    <layout spacing="true" expand="buttons">
        <tabSheet id="tabsheet">
            <tab id="main" caption="msg://caption.mainTab" spacing="true" margin="true">
                <fieldGroup id="attributeFieldGroup" datasource="attributeDs" width="100%">
                    <column>
                        <field id="name" property="name" required="true" width="100%"/>
                        <field id="code" property="code" required="true" width="100%"/>
                        <field id="description" custom="true" width="100%"/>
                        <field id="required" property="required"/>
                        <field id="isCollection" property="isCollection"/>
                        <field id="dataType" custom="true" required="true" width="100%"/>

                        <field id="entityClass" custom="true" required="true" width="100%"/>
                        <field id="screen" custom="true" width="100%"/>
                        <field id="lookup" property="lookup"/>
                        <field id="constraintWizard" custom="true" caption=""/>
                        <field id="joinClause" width="100%" custom="true"/>
                        <field id="whereClause" width="100%" rows="3" custom="true"/>
                        <field id="width" property="width" width="100%">
                            <validator
                                    class="com.haulmont.cuba.gui.app.core.categories.SizeWithUnitValidator"
                                    message="msg://widthValidationMsg"/>
                        </field>
                        <field id="rowsCount" property="rowsCount" width="100%">
                            <validator class="com.haulmont.cuba.gui.components.validators.RangeValidator"
                                       valueType="java.lang.Integer" minValue="1" maxValue="40"
                                       message="msg://rowsCountValidationMsg"/>
                        </field>
                        <field id="defaultEntityId" custom="true" width="100%"/>

                        <field id="enumeration" custom="true" required="true" width="100%"/>
                        <field id="defaultString" property="defaultString" width="100%"/>
                        <field id="defaultInt" property="defaultInt" width="100%"/>
                        <field id="defaultDouble" property="defaultDouble" width="100%"/>
                        <field id="defaultDecimal" property="defaultDecimal" width="100%"/>
                        <field id="defaultBoolean" custom="true" width="100%"/>
                        <field id="defaultDate" property="defaultDate" width="100%"/>
                        <field id="defaultDateWithoutTime" property="defaultDateWithoutTime" width="100%"/>
                        <field id="defaultDateIsCurrent" property="defaultDateIsCurrent" width="100%"/>

                        <field id="numberFormatPattern" property="configuration.numberFormatPattern"
                               width="100%"/>

                        <field id="minInt" property="configuration.minInt" width="100%"/>
                        <field id="minDouble" property="configuration.minDouble" width="100%"/>
                        <field id="minDecimal" property="configuration.minDecimal" width="100%"/>
                        <field id="maxInt" property="configuration.maxInt" width="100%"/>
                        <field id="maxDouble" property="configuration.maxDouble" width="100%"/>
                        <field id="maxDecimal" property="configuration.maxDecimal" width="100%"/>
                    </column>
                </fieldGroup>
            </tab>
            <tab id="localization" caption="msg://caption.localizedNameTab" margin="true" visible="false"/>
            <tab id="validation" caption="msg://caption.validationTab" margin="true,false,true,false">
                <fieldGroup id="validationFieldGroup" datasource="attributeDs" width="100%">
                    <column>
                        <field id="validatorGroovyScript" property="configuration.validatorGroovyScript"
                               width="100%"
                               caption="">
                            <sourceCodeEditor mode="Groovy"
                                              highlightActiveLine="false"
                                              showGutter="false"
                                              property="configuration.validatorGroovyScript"
                                              datasource="attributeDs"/>
                        </field>
                    </column>
                </fieldGroup>
            </tab>
            <tab id="valuesLoader" caption="msg://caption.valuesLoaderTab" margin="true">
                <fieldGroup id="valuesProviderFieldGroup" datasource="attributeDs" width="100%">
                    <column>
                        <field id="valuesLoaderType" property="configuration.valuesLoaderType" width="100%"/>
                        <field id="valuesLoaderScript" property="configuration.valuesLoaderScript" width="100%">
                            <sourceCodeEditor highlightActiveLine="false"
                                              showGutter="false"
                                              property="configuration.valuesLoaderScript"
                                              datasource="attributeDs"/>
                        </field>
                    </column>
                </fieldGroup>
            </tab>
            <tab id="columnSettings" caption="msg://caption.columnSettingsTab" spacing="true" margin="true">
                <fieldGroup id="columnSettingsFieldGroup" datasource="attributeDs" width="100%">
                    <column>
                        <field id="columnName" property="configuration.columnName" width="100%"/>
                        <field id="columnAlignment" width="100%" property="configuration.columnAlignment">
                            <lookupField property="configuration.columnAlignment" datasource="attributeDs"/>
                        </field>
                        <field id="columnWidth" property="configuration.columnWidth" width="100%"/>
                    </column>
                </fieldGroup>
            </tab>
            <tab id="visibility" caption="msg://caption.targetScreensTab" spacing="true" margin="true">
                <table id="targetScreensTable" width="100%" height="250px" editable="true">
                    <buttonsPanel>
                        <button action="targetScreensTable.create"/>
                        <button action="targetScreensTable.remove"/>
                    </buttonsPanel>
                    <columns>
                        <column id="screen" editable="true" caption="msg://sys$ScreenAndComponent.screen"/>
                        <column id="component" editable="true" caption="msg://sys$ScreenAndComponent.component"/>
                    </columns>
                    <rows datasource="screensDs"/>
                </table>
            </tab>
        </tabSheet>
        <frame id="buttons" screen="editWindowActions"/>
    </layout>
</window>